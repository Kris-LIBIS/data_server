- name: 'group + alma + collection'
  description: 'Group files into IEs, get metadata from Alma and create collections'
  stage: 'PreIngest'
  tasks:
    - task: 'FileGrouper'
    - task: 'IeBuilder'
    - task: 'ManifestationBuilder'
    - task: 'MetadataAlmaCollector'
    - task: 'CollectionCreator'
  parameters:
    group_regex:
      targets: ['FileGrouper#group_regex']
    collection_label:
      targets: ['FileGrouper#collection_label']
    group_name:
      targets: ['FileGrouper#group_name']
    group_label:
      targets: ['FileGrouper#group_label']
    file_label:
      targets: ['FileGrouper#file_label']
    collection_navigate:
      targets: ['FileGrouper#collection_navigate']
    collection_publish:
      targets: ['FileGrouper#collection_navigate']
    field:
      targets: ['MetadataAlmaCollector#field']
    term:
      targets: ['MetadataAlmaCollector#term']
    match_regex:
      targets: ['MetadataAlmaCollector#match_regex']
    converter:
      targets: ['MetadataAlmaCollector#converter']
    title_to_name:
      targets: ['MetadataAlmaCollector#title_to_name']
    title_to_label:
      targets: ['MetadataAlmaCollector#title_to_label']
    new_label:
      targets: ['MetadataAlmaCollector#new_label']
    fail_on_not_found:
      targets: ['MetadataAlmaCollector#fail_on_missing']
    base_collection:
      targets: ['CollectionCreator#collection']
